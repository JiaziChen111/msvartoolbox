%% Create tables and graphs after analysis

%% Get FEVD tables first
prctile(cov_array(1,1,1,1,:),2.5,6)
prctile(cov_array(1,1,1,1,:),97.5,6)

%% plotting
load('deliverable1_analysis.mat')
subplot(2,1,1)
plot(0:horizon-1,prctile(squeeze(IRF1(2,1,:,:)),16,2),...
	0:horizon-1,prctile(squeeze(IRF1(2,1,:,:)),50,2),...
	0:horizon-1,prctile(squeeze(IRF1(2,1,:,:)),84,2)...
	)
subplot(2,1,2)
plot(0:horizon-1,prctile(squeeze(IRF2(2,1,:,:)),16,2),...
	0:horizon-1,prctile(squeeze(IRF2(2,1,:,:)),50,2),...
	0:horizon-1,prctile(squeeze(IRF2(2,1,:,:)),84,2)...
	)

figure
subplot(2,1,1)
plot(0:horizon-1,prctile(squeeze(IRF1(3,1,:,:)),16,2),...
	0:horizon-1,prctile(squeeze(IRF1(3,1,:,:)),50,2),...
	0:horizon-1,prctile(squeeze(IRF1(3,1,:,:)),84,2)...
	)
subplot(2,1,2)
plot(0:horizon-1,prctile(squeeze(IRF2(3,1,:,:)),16,2),...
	0:horizon-1,prctile(squeeze(IRF2(3,1,:,:)),50,2),...
	0:horizon-1,prctile(squeeze(IRF2(3,1,:,:)),84,2)...
	)

figure
subplot(2,1,1)
plot(0:horizon-1,prctile(squeeze(IRF1(1,1,:,:)),16,2),...
	0:horizon-1,prctile(squeeze(IRF1(1,1,:,:)),50,2),...
	0:horizon-1,prctile(squeeze(IRF1(1,1,:,:)),84,2)...
	)
subplot(2,1,2)
plot(0:horizon-1,prctile(squeeze(IRF2(1,1,:,:)),16,2),...
	0:horizon-1,prctile(squeeze(IRF2(1,1,:,:)),50,2),...
	0:horizon-1,prctile(squeeze(IRF2(1,1,:,:)),84,2)...
	)

figure
subplot(2,1,1)
plot(0:horizon-1,prctile(squeeze(IRF1(1,2,:,:)),16,2),...
	0:horizon-1,prctile(squeeze(IRF1(1,2,:,:)),50,2),...
	0:horizon-1,prctile(squeeze(IRF1(1,2,:,:)),84,2)...
	)
subplot(2,1,2)
plot(0:horizon-1,prctile(squeeze(IRF2(1,2,:,:)),16,2),...
	0:horizon-1,prctile(squeeze(IRF2(1,2,:,:)),50,2),...
	0:horizon-1,prctile(squeeze(IRF2(1,2,:,:)),84,2)...
	)

figure
subplot(2,1,1)
plot(0:horizon-1,prctile(squeeze(IRF1(3,2,:,:)),16,2),...
	0:horizon-1,prctile(squeeze(IRF1(3,2,:,:)),50,2),...
	0:horizon-1,prctile(squeeze(IRF1(3,2,:,:)),84,2)...
	)
subplot(2,1,2)
plot(0:horizon-1,prctile(squeeze(IRF2(3,2,:,:)),16,2),...
	0:horizon-1,prctile(squeeze(IRF2(3,2,:,:)),50,2),...
	0:horizon-1,prctile(squeeze(IRF2(3,2,:,:)),84,2)...
	)